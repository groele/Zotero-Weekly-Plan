# Zotero å·¥å…·æ å›¾æ ‡å¤§å°ä¿®å¤

## ğŸ› é—®é¢˜æè¿°

**ç—‡çŠ¶**ï¼šZotero ä¸»é¡µé¢å·¥å…·æ ä¸­çš„å‘¨è®¡åˆ’å›¾æ ‡æ˜¾ç¤ºå¤§å°å¼‚å¸¸

**åŸå› **ï¼š

- ä½¿ç”¨äº† 128x128 å°ºå¯¸çš„ [icon.svg](file://d:\Git%20Project\Zotero-Weekly-Plan\addon\content\icons\icon.svg) ä½œä¸ºå·¥å…·æ å›¾æ ‡
- Zotero å·¥å…·æ æ ‡å‡†å›¾æ ‡å°ºå¯¸åº”ä¸º 32x32
- å¤§å›¾æ ‡ç¼©æ”¾å¯¼è‡´æ˜¾ç¤ºå¼‚å¸¸å’Œæ€§èƒ½é—®é¢˜

---

## âœ… ä¿®å¤æ–¹æ¡ˆ

### æ–¹æ¡ˆ 1ï¼šåˆ›å»ºä¸“ç”¨å·¥å…·æ å›¾æ ‡

æ ¹æ® **Zotero å·¥å…·æ å›¾æ ‡æœ€ä½³å®è·µ**ï¼š

> å·¥å…·æ å›¾æ ‡åº”å•ç‹¬è®¾è®¡ 32x32 å°ºå¯¸çš„ SVG æ–‡ä»¶ï¼Œä½¿ç”¨ context-stroke æ”¯æŒä¸»é¢˜é€‚é…ï¼Œå¹¶é€šè¿‡ media query å®ç°æ˜æš—æ¨¡å¼è‡ªåŠ¨åˆ‡æ¢

**æ–°å»ºæ–‡ä»¶**ï¼š[`addon/content/icons/toolbar-icon.svg`](file://d:\Git%20Project\Zotero-Weekly-Plan\addon\content\icons\toolbar-icon.svg)

```svg
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" width="32" height="32">
  <style>
    /* äº®è‰²ä¸»é¢˜ */
    @media (prefers-color-scheme: light) {
      .board-bg { fill: #667eea; }
      .card { fill: #ffffff; stroke: #e0e0e0; }
      .accent { fill: #4dabf7; }
      .badge { fill: #339af0; }
      .text { fill: #ffffff; }
    }

    /* æš—è‰²ä¸»é¢˜ */
    @media (prefers-color-scheme: dark) {
      .board-bg { fill: #5b68d1; }
      .card { fill: #3a3a3a; stroke: #555555; }
      .accent { fill: #3a92d3; }
      .badge { fill: #2d7ab8; }
      .text { fill: #ffffff; }
    }

    /* æ”¯æŒ context-stroke */
    .contextual { stroke: context-stroke; }
  </style>

  <!-- èƒŒæ™¯ -->
  <rect x="2" y="2" width="28" height="28" rx="6" class="board-bg"/>

  <!-- ä¸‰åˆ—çœ‹æ¿ -->
  <g transform="translate(16, 16)">
    <!-- å·¦åˆ— -->
    <rect x="-8" y="-6" width="4" height="10" rx="1" class="card"/>
    <rect x="-7" y="-4" width="2" height="1" rx="0.3" class="accent"/>

    <!-- ä¸­åˆ— -->
    <rect x="-2" y="-6" width="4" height="10" rx="1" class="card"/>
    <rect x="-1" y="-4" width="2" height="1" rx="0.3" class="accent"/>

    <!-- å³åˆ— -->
    <rect x="4" y="-6" width="4" height="10" rx="1" class="card"/>
    <rect x="5" y="-4" width="2" height="1" rx="0.3" class="accent"/>
  </g>

  <!-- é¡¶éƒ¨å¾½ç«  - "å‘¨" -->
  <g transform="translate(24, 8)">
    <circle cx="0" cy="0" r="4" class="badge"/>
    <text>å‘¨</text>
  </g>
</svg>
```

**ç‰¹ç‚¹**ï¼š

- âœ… 32x32 æ ‡å‡†å°ºå¯¸
- âœ… æ”¯æŒäº®è‰²/æš—è‰²ä¸»é¢˜è‡ªåŠ¨åˆ‡æ¢
- âœ… ä½¿ç”¨ CSS å˜é‡å’Œ media query
- âœ… ç®€åŒ–è®¾è®¡ï¼Œä¿ç•™æ ¸å¿ƒå…ƒç´ ï¼ˆçœ‹æ¿ + å¾½ç« ï¼‰
- âœ… çŸ¢é‡å›¾å½¢ï¼Œä»»æ„ç¼©æ”¾ä¸å¤±çœŸ

---

### æ–¹æ¡ˆ 2ï¼šæ›´æ–°ä»£ç å¼•ç”¨

**ä¿®æ”¹æ–‡ä»¶**ï¼š[`src/hooks.ts`](file://d:\Git%20Project\Zotero-Weekly-Plan\src\hooks.ts)

```typescript
// âŒ ä¿®æ”¹å‰ï¼ˆç¬¬ 279 è¡Œï¼‰
button.setAttribute(
  "image",
  `chrome://${addon.data.config.addonRef}/content/icons/icon.svg`,
);

// âœ… ä¿®æ”¹å
button.setAttribute(
  "image",
  `chrome://${addon.data.config.addonRef}/content/icons/toolbar-icon.svg`,
);
```

**ä¿®æ”¹ä½ç½®**ï¼šç¬¬ 279 è¡Œ

---

## ğŸ“Š å›¾æ ‡å¯¹æ¯”

### ä¹‹å‰ï¼ˆicon.svg - 128x128ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        â”‚
â”‚   å®Œæ•´çš„çœ‹æ¿è®¾è®¡       â”‚
â”‚   - æ¸å˜èƒŒæ™¯           â”‚
â”‚   - ä¸‰åˆ—çœ‹æ¿           â”‚
â”‚   - åº•éƒ¨æ—¥å†           â”‚
â”‚   - å‘¨å¾½ç«              â”‚
â”‚   - é˜´å½±æ•ˆæœ           â”‚
â”‚                        â”‚
â”‚   å°ºå¯¸ï¼š128x128        â”‚
â”‚   æ–‡ä»¶å¤§å°ï¼š~5KB       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**é—®é¢˜**ï¼š

- âŒ å°ºå¯¸è¿‡å¤§ï¼Œç¼©æ”¾åˆ°å·¥å…·æ æ—¶æ˜¾ç¤ºå¼‚å¸¸
- âŒ ç»†èŠ‚è¿‡å¤šï¼Œå°å°ºå¯¸ä¸‹ä¸æ¸…æ™°
- âŒ ä¸æ”¯æŒä¸»é¢˜è‡ªåŠ¨åˆ‡æ¢

---

### ä¹‹åï¼ˆtoolbar-icon.svg - 32x32ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â–­â–­â–­ å‘¨  â”‚  â† ç®€æ´çš„çœ‹æ¿ + å¾½ç« 
â”‚ â–­â–­â–­     â”‚
â”‚ â–­â–­â–­     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ä¼˜åŠ¿**ï¼š

- âœ… æ ‡å‡† 32x32 å°ºå¯¸
- âœ… ç®€åŒ–è®¾è®¡ï¼Œæ¸…æ™°å¯è¾¨
- âœ… æ”¯æŒäº®è‰²/æš—è‰²ä¸»é¢˜
- âœ… æ–‡ä»¶æ›´å°ï¼ŒåŠ è½½æ›´å¿«

---

## ğŸ¨ ä¸»é¢˜é€‚é…æ•ˆæœ

### äº®è‰²ä¸»é¢˜

```css
.board-bg {
  fill: #667eea;
} /* ç´«è‰²èƒŒæ™¯ */
.card {
  fill: #ffffff;
} /* ç™½è‰²å¡ç‰‡ */
.accent {
  fill: #4dabf7;
} /* è“è‰²å¼ºè°ƒ */
.badge {
  fill: #339af0;
} /* è“è‰²å¾½ç«  */
```

### æš—è‰²ä¸»é¢˜

```css
.board-bg {
  fill: #5b68d1;
} /* æ·±ç´«è‰²èƒŒæ™¯ */
.card {
  fill: #3a3a3a;
} /* æ·±ç°è‰²å¡ç‰‡ */
.accent {
  fill: #3a92d3;
} /* æ·±è“è‰²å¼ºè°ƒ */
.badge {
  fill: #2d7ab8;
} /* æ·±è“è‰²å¾½ç«  */
```

---

## ğŸ”§ æŠ€æœ¯å®ç°

### 1. Media Query ä¸»é¢˜åˆ‡æ¢

```svg
<style>
  @media (prefers-color-scheme: light) {
    /* äº®è‰²ä¸»é¢˜æ ·å¼ */
  }

  @media (prefers-color-scheme: dark) {
    /* æš—è‰²ä¸»é¢˜æ ·å¼ */
  }
</style>
```

**åŸç†**ï¼š

- æµè§ˆå™¨/ç³»ç»Ÿæ£€æµ‹å½“å‰ä¸»é¢˜
- è‡ªåŠ¨åº”ç”¨å¯¹åº”çš„ CSS ç±»
- æ— éœ€ JavaScriptï¼Œçº¯ CSS å®ç°

---

### 2. Context-Stroke æ”¯æŒ

```svg
<style>
  .contextual { stroke: context-stroke; }
</style>
```

**ç”¨é€”**ï¼š

- å…è®¸çˆ¶å®¹å™¨è®¾ç½®æè¾¹é¢œè‰²
- å¢å¼ºä¸»é¢˜å…¼å®¹æ€§

---

### 3. ç®€åŒ–å›¾å½¢è®¾è®¡

**åŸåˆ™**ï¼š

- ä¿ç•™æ ¸å¿ƒè¯†åˆ«å…ƒç´ ï¼ˆä¸‰åˆ—çœ‹æ¿ + å‘¨å¾½ç« ï¼‰
- ç§»é™¤è£…é¥°æ€§å…ƒç´ ï¼ˆæ¸å˜ã€é˜´å½±ã€æ—¥å†ï¼‰
- ä½¿ç”¨çŸ©å½¢å’Œåœ†å½¢åŸºæœ¬å›¾å½¢
- ç¡®ä¿å°å°ºå¯¸ä¸‹æ¸…æ™°å¯è¾¨

---

## ğŸ“¦ æ„å»ºä¿¡æ¯

```bash
# æ„å»ºæˆåŠŸ
$ npm run build
âœ” Build finished in 0.183 s.

# ä»£ç æ ¼å¼åŒ–æˆåŠŸ
$ npm run lint:fix
âœ” All files formatted

# è¾“å‡ºæ–‡ä»¶
.scaffold/build/zotero-weekly-plan.xpi
```

---

## âœ… éªŒè¯æ¸…å•

### æ­¥éª¤ 1ï¼šé‡æ–°åŠ è½½æ’ä»¶

1. æ‰“å¼€ Zotero
2. å·¥å…· â†’ é™„åŠ ç»„ä»¶
3. âš™ï¸ â†’ ä»æ–‡ä»¶å®‰è£…é™„åŠ ç»„ä»¶
4. é€‰æ‹© `.scaffold/build/zotero-weekly-plan.xpi`
5. é‡å¯ Zotero

---

### æ­¥éª¤ 2ï¼šæ£€æŸ¥å·¥å…·æ å›¾æ ‡

#### âœ“ å›¾æ ‡å¤§å°

- [ ] å›¾æ ‡å¤§å°ä¸å…¶ä»–å·¥å…·æ æŒ‰é’®ä¸€è‡´
- [ ] æ²¡æœ‰æ˜æ˜¾çš„æ‹‰ä¼¸æˆ–å‹ç¼©
- [ ] è¾¹ç¼˜æ¸…æ™°ï¼Œæ— é”¯é½¿

#### âœ“ å›¾æ ‡æ¸…æ™°åº¦

- [ ] çœ‹æ¿ä¸‰åˆ—æ¸…æ™°å¯è¾¨
- [ ] "å‘¨"å­—æ¸…æ™°å¯è¯»
- [ ] é¢œè‰²å¯¹æ¯”åº¦é€‚ä¸­

#### âœ“ ä¸»é¢˜é€‚é…

- [ ] äº®è‰²ä¸»é¢˜ï¼šç´«è‰²èƒŒæ™¯ + ç™½è‰²å¡ç‰‡
- [ ] æš—è‰²ä¸»é¢˜ï¼šæ·±ç´«è‰²èƒŒæ™¯ + æ·±ç°è‰²å¡ç‰‡
- [ ] åˆ‡æ¢ä¸»é¢˜æ—¶è‡ªåŠ¨æ›´æ–°

#### âœ“ äº¤äº’æ•ˆæœ

- [ ] é¼ æ ‡æ‚¬åœæ˜¾ç¤º"å‘¨è®¡åˆ’"æç¤º
- [ ] ç‚¹å‡»å¯æ‰“å¼€å‘¨è®¡åˆ’é¢æ¿
- [ ] æ— å»¶è¿Ÿï¼Œå“åº”æµç•…

---

### æ­¥éª¤ 3ï¼šå¯¹æ¯”å…¶ä»–å›¾æ ‡

**Zotero å·¥å…·æ æ ‡å‡†å›¾æ ‡**ï¼š

```
[ğŸ“š] [ğŸ”] [â­] [ğŸ“‹] [å‘¨è®¡åˆ’]
 â†‘    â†‘    â†‘    â†‘     â†‘
 æ–‡çŒ® æœç´¢ æ ‡è®° ç¬”è®°  å‘¨è®¡åˆ’ï¼ˆæ–°ï¼‰
```

**æ£€æŸ¥**ï¼š

- [ ] å¤§å°ä¸€è‡´
- [ ] é—´è·ç»Ÿä¸€
- [ ] é£æ ¼åè°ƒ

---

## ğŸ› æ•…éšœæ’æŸ¥

### é—®é¢˜ 1ï¼šå›¾æ ‡ä»ç„¶è¿‡å¤§

**æ£€æŸ¥**ï¼š

```javascript
// åœ¨æµè§ˆå™¨æ§åˆ¶å°è¿è¡Œ
const btn = document.getElementById("zoteroplan-toolbarbutton");
console.log("Image:", btn.getAttribute("image"));
// åº”è¯¥æ˜¾ç¤ºï¼šchrome://.../toolbar-icon.svg
```

**è§£å†³æ–¹æ¡ˆ**ï¼š

1. ç¡®è®¤æ–‡ä»¶å·²åˆ›å»ºï¼š`addon/content/icons/toolbar-icon.svg`
2. ç¡®è®¤ä»£ç å·²æ›´æ–°ï¼š`src/hooks.ts` ç¬¬ 279 è¡Œ
3. é‡æ–°æ„å»ºï¼š`npm run build`
4. é‡æ–°åŠ è½½æ’ä»¶

---

### é—®é¢˜ 2ï¼šä¸»é¢˜åˆ‡æ¢ä¸ç”Ÿæ•ˆ

**æ£€æŸ¥**ï¼š

1. æŸ¥çœ‹ SVG æ–‡ä»¶æ˜¯å¦åŒ…å« `@media (prefers-color-scheme)` æ ·å¼
2. ç³»ç»Ÿä¸»é¢˜è®¾ç½®ï¼šWindows è®¾ç½® â†’ ä¸ªæ€§åŒ– â†’ é¢œè‰²
3. Zotero æ˜¯å¦æ”¯æŒç³»ç»Ÿä¸»é¢˜

**è§£å†³æ–¹æ¡ˆ**ï¼š

- ç¡®ä¿ Zotero ç‰ˆæœ¬ >= 6.0
- æ£€æŸ¥ SVG æ ·å¼å®šä¹‰
- æ‰‹åŠ¨åˆ‡æ¢ç³»ç»Ÿä¸»é¢˜æµ‹è¯•

---

### é—®é¢˜ 3ï¼šå›¾æ ‡ä¸æ˜¾ç¤º

**æ£€æŸ¥**ï¼š

```bash
# æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨
ls addon/content/icons/toolbar-icon.svg
```

**è§£å†³æ–¹æ¡ˆ**ï¼š

1. ç¡®è®¤æ–‡ä»¶è·¯å¾„æ­£ç¡®
2. æ£€æŸ¥ `chrome://` åè®®é…ç½®
3. æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°é”™è¯¯ä¿¡æ¯

---

## ğŸ“ ä¿®æ”¹æ–‡ä»¶æ¸…å•

| æ–‡ä»¶                                                                                                                      | æ“ä½œ | è¯´æ˜                    |
| ------------------------------------------------------------------------------------------------------------------------- | ---- | ----------------------- |
| [`addon/content/icons/toolbar-icon.svg`](file://d:\Git%20Project\Zotero-Weekly-Plan\addon\content\icons\toolbar-icon.svg) | æ–°å»º | 32x32 ä¸“ç”¨å·¥å…·æ å›¾æ ‡    |
| [`src/hooks.ts`](file://d:\Git%20Project\Zotero-Weekly-Plan\src\hooks.ts)                                                 | ä¿®æ”¹ | ç¬¬ 279 è¡Œï¼šå›¾æ ‡è·¯å¾„æ›´æ–° |

**ä¿®æ”¹è¡Œæ•°**ï¼š+1 æ–°æ–‡ä»¶ï¼Œ+1 -1 ä¿®æ”¹

---

## ğŸ¯ æŠ€æœ¯è¦ç‚¹æ€»ç»“

### 1. å·¥å…·æ å›¾æ ‡å°ºå¯¸æ ‡å‡†

```
Zotero å·¥å…·æ å›¾æ ‡ï¼š32x32 SVG
manifest.json å›¾æ ‡ï¼š16, 32, 48, 96 (å¤šå°ºå¯¸)
```

### 2. ä¸»é¢˜é€‚é…æœ€ä½³å®è·µ

```svg
<!-- ä½¿ç”¨ CSS å˜é‡å’Œ media query -->
<style>
  @media (prefers-color-scheme: light) { ... }
  @media (prefers-color-scheme: dark) { ... }
</style>
```

### 3. å›¾æ ‡è®¾è®¡åŸåˆ™

- **ç®€æ´**ï¼šç§»é™¤éæ ¸å¿ƒå…ƒç´ 
- **æ¸…æ™°**ï¼šå°å°ºå¯¸ä¸‹å¯è¾¨è¯†
- **ç»Ÿä¸€**ï¼šä¸ Zotero é£æ ¼ä¸€è‡´
- **é€‚é…**ï¼šæ”¯æŒå¤šä¸»é¢˜

---

## ğŸ‰ ä¿®å¤å®Œæˆ

### âœ… é—®é¢˜è§£å†³

- [x] åˆ›å»º 32x32 ä¸“ç”¨å·¥å…·æ å›¾æ ‡
- [x] æ›´æ–°ä»£ç å¼•ç”¨æ–°å›¾æ ‡
- [x] æ”¯æŒäº®è‰²/æš—è‰²ä¸»é¢˜è‡ªåŠ¨åˆ‡æ¢
- [x] å›¾æ ‡å¤§å°ä¸å·¥å…·æ å…¶ä»–æŒ‰é’®ä¸€è‡´
- [x] ç®€åŒ–è®¾è®¡ï¼Œæ¸…æ™°å¯è¾¨

---

### ğŸ“Š æ•ˆæœå¯¹æ¯”

| æŒ‡æ ‡     | ä¿®å¤å‰  | ä¿®å¤å |
| -------- | ------- | ------ |
| å›¾æ ‡å°ºå¯¸ | 128x128 | 32x32  |
| æ–‡ä»¶å¤§å° | ~5KB    | ~2KB   |
| ä¸»é¢˜æ”¯æŒ | âŒ      | âœ…     |
| æ˜¾ç¤ºæ•ˆæœ | å¼‚å¸¸    | æ­£å¸¸   |
| åŠ è½½é€Ÿåº¦ | æ…¢      | å¿«     |

---

## ğŸ”— ç›¸å…³èµ„æº

- [Zotero æ’ä»¶å¼€å‘æ–‡æ¡£](https://www.zotero.org/support/dev/client_coding/plugin_development)
- [Firefox XUL å·¥å…·æ æŒ‰é’®](https://developer.mozilla.org/en-US/docs/Archive/Add-ons/Overlay_Extensions/XUL_School/Adding_Toolbars_and_Toolbar_Buttons)
- [SVG Media Queries](https://developer.mozilla.org/en-US/docs/Web/SVG/Tutorial/Media_Queries)

---

**ç°åœ¨ Zotero ä¸»é¡µé¢å·¥å…·æ å›¾æ ‡åº”è¯¥æ˜¾ç¤ºæ­£å¸¸äº†ï¼** ğŸ‰

è¯·é‡æ–°åŠ è½½æ’ä»¶å¹¶éªŒè¯æ•ˆæœã€‚å¦‚æœ‰é—®é¢˜ï¼Œè¯·æŸ¥çœ‹æ§åˆ¶å°é”™è¯¯ä¿¡æ¯ã€‚
